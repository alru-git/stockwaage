<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="refresh" content="900"><script type="text/javascript"  src="dygraph.js"></script><link href="dygraph.css" rel="stylesheet" type="text/css"/></head><body><table border="0">    <tr><th>Digitale Stockwaage 1</th></tr>	<tr><td>_________________________________________</td></tr>	<tr><td>                                         </td></tr></table><?php// Detailwerte auslesen und anzeigenclass spalten					// es werden 12 Spalten eingelesen{    public $eins;    public $zwei;    public $drei;    public $vier;    public $fuenf;    public $sechs;    public $sieben;    public $acht;    public $neun;    public $zehn;    public $elf;    public $zwoelf;                                 }$h = fopen('waage1.csv', 'rb');$objs = array();while ($entry = fgetcsv($h, 0, ',', '"', '\\')) {    $tmp = new spalten();    $tmp->eins   = $entry[0];    $tmp->zwei   = $entry[1];    $tmp->drei = $entry[2];    $tmp->vier  = $entry[3];    $tmp->fuenf  = $entry[4];    $tmp->sechs  = $entry[5];    $tmp->sieben  = $entry[6];    $tmp->acht  = $entry[7];    $tmp->neun  = $entry[8];    $tmp->zehn  = $entry[9];    $tmp->elf  = $entry[10];    $tmp->zwoelf  = $entry[11];        $objs[] = $tmp;}fclose($h);$c = count($objs) -1;			// Zähler für die letzte Zeile mit den aktuellen Daten$d = $c-48; 					// Zähler für die Werte von vor 24h, alle 30min werden Daten gespeichertecho "Letzte Messung vom: " . $objs[$c]->eins . "&nbsp;&nbsp;&nbsp;(Aktualisierung alle 30 Min.)<br />";echo "<br />";// Differenzwerte zum Vortag ermitteln und formatieren$gew = round($objs[$c]->zwei - $objs[$d]->zwei, 2);$temp = round($objs[$c]->drei - $objs[$d]->drei, 1);$hum = round($objs[$c]->vier - $objs[$d]->vier, 0);$vol = round($objs[$c]->fuenf - $objs[$d]->fuenf, 2);// Tabelle zur Anzeige aller Werte, diff- Werte werden mit Vorzeichen angezeigtecho "<table>";echo "<tr><th><u>Messwerte:</u></th><th></th><th><u>&nbsp;&nbsp;Aktuell&nbsp;&nbsp;</u></th><th><u>&nbsp;&nbsp;Diff. Vortag&nbsp;&nbsp;</u></th></tr>";echo "<tr><td><span style='color:red;font-weight: bold'>Gewicht</td><td>[kg]:</td><td align=center>" . $objs[$c]->zwei . "</td><td align=center>" . sprintf("%+01.2f", $gew) . " </td></tr>";echo "<tr><td><span style='color:blue;font-weight: bold'>Temperatur</td><td>[°C]:</td><td align=center>" . $objs[$c]->drei . " </td><td align=center>" . sprintf("%+01.1f", $temp) . "  </td></tr>";echo "<tr><td><span style='color:green;font-weight: bold'>Luftfeuchte</td><td>[%]:</td><td align=center>" . $objs[$c]->vier . "  </td><td align=center>" . sprintf("%+d", $hum) . "  </td></tr>";echo "<tr><td><span style='color:black;font-weight: bold'>Spannung</td><td>[V]:</td><td align=center>" . $objs[$c]->fuenf . " </td><td align=center>" . sprintf("%+01.2f", $vol) . " </td></tr>";echo "</table>";echo "<br />";?><div id="graphdiv"style="width:700px; height:400px;"></div><!-- .dygraph-legend style muss hier zusätzlich zum css eingefügt werden --><style>.dygraph-legend {  position: absolute;  font-size: 14px;  z-index: 10;  width: 600px;    top: 0px;  right: 20px;  background: white;  line-height: normal;  text-align: center;  overflow: hidden;}</style><p><b>Display:</b><br/><input type=checkbox id=0 onClick="change(this)" checked><label for="0"><span style="color:red"> Gewicht </label><input type=checkbox id=1 onClick="change(this)" checked><label for="1"><span style="color:blue"> Temperatur </label><input type=checkbox id=2 onClick="change(this)" checked><label for="2"><span style="color:green"> Luftfeuchte </label><input type=checkbox id=3 onClick="change(this)"><label for="3"><span style="color:black"> Spannung </label><br/><input type=checkbox id=4 onClick="change(this)"><label for="0"><span style="color:blue"> Außen-Temp. </label><input type=checkbox id=5 onClick="change(this)"><label for="0"><span style="color:green"> Außen-Luftf. </label><input type=checkbox id=6 onClick="change(this)"><label for="0"><span style="color:fuchsia"> Lufdruck </label><input type=checkbox id=7 onClick="change(this)"><label for="0"><span style="color:teal"> Regen </label><input type=checkbox id=8 onClick="change(this)"><label for="0"><span style="color:navy"> Wind </label><input type=checkbox id=9 onClick="change(this)"><label for="0"><span style="color:navy"> Windrichtung </label><input type=checkbox id=10 onClick="change(this)"><label for="0"><span style="color:olive"> Helligkeit </label></p><script type="text/javascript">  g = new Dygraph(    document.getElementById("graphdiv"),    "waage1.csv",        {		strokeWidth: 2,		legend: 'always',	    xlabel: 'Datum und Zeit',		ylabel: 'Luftdruck [hPa]',		y2label: 'Messwerte',		visibility: [true, true, true, false, false, false, false, false, false, false, false],		dateWindow: [			+new Date() - 1 * 7 * 24 * 60 * 60 * 1000,  // x-Achse Start: vor 1 Woche			+new Date()  								// Ende: Heute				],		series: {            'Gewicht[kg]': {                color: "red",                axis: "y2"							},			'Temperatur[°C]': {                color: "blue",                axis: "y2"							},			'Luftfeuchte[%]': {                color: "green",                axis: "y2" 							},			'Spannung[V]': {                color: "black",                axis: "y2"							},			'A-Temperatur[°C]': {                color: "blue",				strokePattern: Dygraph.DASHED_LINE,				axis: "y2"							},			'A-Luftfeuchte[%]': {                color: "green",				strokePattern: Dygraph.DASHED_LINE,				axis: "y2"							},			'Luftdruck[hPa]': {                color: "fuchsia" 							},			'Regen[l/m²]': {                color: "teal",                axis: "y2"							},			'Wind[km/h]': {                color: "navy",                axis: "y2",                strokePattern: Dygraph.DOT_DASH_LINE							},																										'Windrichtung[°]': {                color: "navy",                axis: "y2",                strokePattern: [2, 2] // DOTTED_LINE funktioniert nicht							},							'Helligkeit[lux]': {                color: "olive",                axis: "y2"							}							},		axes: {		y: {			independentTicks: false,			valueRange: [950, 1050]               },        y2: {            independentTicks: true,               }            }		}  );     g.ready(function() {    g.setAnnotations([    {      series: "Spannung[V]",      x: "2019/03/09 13:30",      shortText: "V",      text: "Testbetrieb mit Solarpanel"	 },    {      series: "Gewicht[kg]",      x: "2019/03/09 13:30",      shortText: "G",      text: "Testbetrieb im Garten"    },    {      series: "Temperatur[°C]",      x: "2019/03/09 13:30",      shortText: "T",      text: "Testbetrieb im Garten"    },    {      series: "Luftfeuchte[%]",      x: "2019/03/09 13:30",      shortText: "F",      text: "Testbetrieb im Garten"	 }    ]);  });      setStatus();      function setStatus() {        document.getElementById("visibility").innerHTML =          g.visibility().toString();      }      function change(el) {        g.setVisibility(parseInt(el.id), el.checked);        setStatus();      }</script></body></html>